{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Eventos para Peleadores - Fight.net</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
   <style>
    .bg-black {
      background-color: #000 !important;
    }
    .evento-card {
      background-color: #1a1a1a;
      border: 1px solid #333;
      color: white;
    }
    .modal-evento {
      background-color: #1a1a1a;
      color: white;
    }
    .modal-evento .modal-body {
      color: white !important;
    }
    .modal-evento .modal-body p {
      color: white !important;
    }
    .modal-evento .modal-header {
      color: white !important;
    }
    .modal-evento .modal-title {
      color: white !important;
    }
    .section-title {
      color: white;
    }
  </style>
</head>
<body class="bg-black text-white">
  <nav class="navbar navbar-expand-lg navbar-dark border-bottom border-danger">
    <div class="container">
      <a class="navbar-brand fw-bold" href="#">FIGHT.NET</a>
    </div>
    <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#crearEventoModal">
        <i class="bi bi-plus-circle me-2"></i>Crear Evento
    </button>
  </nav>
  <div class="container py-5 mt-4">
    <h2 class="section-title mb-4">Eventos Disponibles</h2>

    <div class="row g-4">
      {% for evento in eventos %}
      <div class="col-md-6 col-lg-4">
        <div class="card evento-card h-100">
          <div class="card-body">
            <div class="event-date badge bg-danger mb-2">{{ evento.data|date:"d M Y" }}</div>
            <h5 class="card-title">{{ evento.nombre }}</h5>
            <p class="card-text"><i class="bi bi-geo-alt"></i> {{ evento.localizacion }}</p>
            <div class="d-flex justify-content-between align-items-center">
              <span class="badge bg-secondary">{{ evento.disciplina }}</span>
              <button class="btn btn-outline-danger btn-sm" data-bs-toggle="modal" data-bs-target="#eventDetailModal{{ evento.id }}">Ver Detalles</button>
            </div>
          </div>
        </div>
      </div>
      <div class="modal fade" id="eventDetailModal{{ evento.id }}" tabindex="-1" aria-labelledby="eventDetailModalLabel{{ evento.id }}" aria-hidden="true">
        <div class="modal-dialog modal-lg">
          <div class="modal-content modal-evento">
            <div class="modal-header">
              <h5 class="modal-title" id="eventDetailModalLabel{{ evento.id }}">{{ evento.nombre }}</h5>
              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
              <p><strong>Disciplina:</strong> {{ evento.disciplina }}</p>
              <p><strong>Fecha:</strong> {{ evento.data|date:"d M Y" }}</p>
              <p><strong>Ubicación:</strong> {{ evento.localizacion }}</p>
              <p><strong>Organizador:</strong> {{ evento.organizador }}</p>
              <p><strong>Descripción:</strong> {{ evento.descripcion }}</p>
            </div>
            <div class="modal-footer justify-content-between">
              <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Cerrar</button>
            </div>
            <div>
                <button type="button" class="btn btn-edit btn-sm me-2" data-bs-toggle="modal" data-bs-target="#editEventoModal{{ evento.id }}" data-bs-dismiss="modal">
                  <i class="bi bi-pencil me-1"></i>Editar
                </button>
                <button type="button" class="btn btn-delete btn-sm" onclick="confirmarEliminar({{ evento.id }})">
                  <i class="bi bi-trash me-1"></i>Eliminar
                </button>
              </div>
          </div>
        </div>
      </div>
      {% empty %}
      <p>No hay eventos disponibles.</p>
      {% endfor %}
    </div>
  </div>
    <div class="modal fade" id="crearEventoModal" tabindex="-1" aria-labelledby="crearEventoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content modal-evento">
        <div class="modal-header border-danger">
          <h5 class="modal-title" id="crearEventoModalLabel">
            <i class="bi bi-calendar-plus me-2"></i>Crear Nuevo Evento
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <form method="post" id="crearEventoForm">
          {% csrf_token %}
          <div class="modal-body">
            <div class="row g-3">
              <div class="col-md-6">
                <label for="nombre" class="form-label text-white">Nombre del Evento *</label>
                <input type="text" class="form-control bg-dark text-white border-secondary" id="nombre" name="nombre" required>
              </div>
              <div class="col-md-6">
                <label for="disciplina" class="form-label text-white">Disciplina *</label>
                <select class="form-select bg-dark text-white border-secondary" id="disciplina" name="disciplina" required>
                  <option value="">Seleccionar disciplina</option>
                  <option value="MMA">MMA</option>
                  <option value="Boxeo">Boxeo</option>
                  <option value="Kickboxing">Kickboxing</option>
                  <option value="Muay Thai">Muay Thai</option>
                  <option value="Jiu-Jitsu">Jiu-Jitsu</option>
                  <option value="Karate">Karate</option>
                  <option value="Taekwondo">Taekwondo</option>
                </select>
              </div>
              <div class="col-md-6">
                <label for="data" class="form-label text-white">Fecha del Evento *</label>
                <input type="datetime-local" class="form-control bg-dark text-white border-secondary" id="data" name="data_input" required>
                <!-- Campo hidden que contendrá el formato correcto -->
                <input type="hidden" id="data_formatted" name="data">
              </div>
              <div class="col-md-6">
                <label for="organizador" class="form-label text-white">Organizador *</label>
                <input type="text" class="form-control bg-dark text-white border-secondary" id="organizador" name="organizador" required>
              </div>
              <div class="col-md-6">
                <label for="usuario" class="form-label text-white">ID Usuario *</label>
                <input type="number" class="form-control bg-dark text-white border-secondary" id="usuario" name="usuario" required placeholder="Ingresa tu ID de usuario">
              </div>
              <div class="col-md-6">
                <label for="localizacion" class="form-label text-white">Ubicación *</label>
                <input type="text" class="form-control bg-dark text-white border-secondary" id="localizacion" name="localizacion" placeholder="Ciudad, Estado/País" required>
              </div>
              <div class="col-12">
                <label for="descripcion" class="form-label text-white">Descripción</label>
                <textarea class="form-control bg-dark text-white border-secondary" id="descripcion" name="descripcion" rows="4" placeholder="Describe los detalles del evento, categorías, premios, etc."></textarea>
              </div>
            </div>
          </div>
          <div class="modal-footer border-danger justify-content-between">
            <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Cancelar</button>
            <button type="submit" class="btn btn-danger">
              <i class="bi bi-check2-circle me-1"></i>Crear Evento
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.getElementById('crearEventoForm').addEventListener('submit', function(e) {
      const dataInput = document.getElementById('data');
      const dataFormatted = document.getElementById('data_formatted');
      
      if (dataInput.value) {
        // Convertir datetime-local a formato YYYY-MM-DD HH:MM:SS
        const date = new Date(dataInput.value);
        const formattedDate = date.getFullYear() + '-' + 
                             String(date.getMonth() + 1).padStart(2, '0') + '-' + 
                             String(date.getDate()).padStart(2, '0') + ' ' + 
                             String(date.getHours()).padStart(2, '0') + ':' + 
                             String(date.getMinutes()).padStart(2, '0') + ':00';
        dataFormatted.value = formattedDate;
      }
    });
  </script>
</html>